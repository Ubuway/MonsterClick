<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MONSTORCLIK | Продвинутый кликер</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7C3AED;
            --secondary: #10B981;
            --dark: #0F172A;
            --darker: #0A0F1C;
            --light: #F8FAFC;
            --accent: #F59E0B;
            --danger: #EF4444;
            --success: #10B981;
            --warning: #F59E0B;
            --skin-rare: #06D6A0;
            --skin-epic: #9D4EDD;
            --skin-legendary: #FF6B35;
            --skin-mythic: #FF006E;
            --energy: #3B82F6;
            --purple-dark: #5B21B6;
            --purple-light: #8B5CF6;
            --gold: #FBBF24;
            --platinum: #E5E7EB;
            --diamond: #60A5FA;
            --radius: 20px;
            --radius-sm: 12px;
            --radius-lg: 30px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'SF Pro Display', system-ui, sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
        
        body {
            background: linear-gradient(135deg, #0A0F1C 0%, #1E293B 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            touch-action: manipulation;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.1) 0%, transparent 50%);
            z-index: -1;
        }
        
        /* СНЕЖИНКИ */
        #snowflakes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .snowflake {
            position: absolute;
            top: -50px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.5rem;
            opacity: 0.7;
            animation: snowFall linear infinite;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }
        
        @keyframes snowFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0.8;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* АВТОРИЗАЦИЯ */
        #authScreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background: rgba(10, 15, 28, 0.95);
            backdrop-filter: blur(10px);
            z-index: 2000;
            overflow: auto;
        }
        
        .auth-container {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.95) 0%, 
                rgba(15, 23, 42, 0.98) 100%);
            border-radius: var(--radius-lg);
            padding: 30px 20px;
            width: 100%;
            max-width: 500px;
            border: 2px solid var(--primary);
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(124, 58, 237, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            text-align: center;
            animation: fadeIn 0.5s ease-out;
            margin: auto;
        }
        
        .auth-title h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 900;
            letter-spacing: 1px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--accent) 50%, 
                var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 4px 20px rgba(124, 58, 237, 0.3);
            position: relative;
        }
        
        .auth-title h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            right: 25%;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent, 
                var(--primary), 
                transparent);
        }
        
        .auth-subtitle {
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
            margin-bottom: 30px;
            line-height: 1.5;
            padding: 0 10px;
        }
        
        .player-id {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.15) 0%, 
                rgba(139, 92, 246, 0.08) 100%);
            padding: 15px;
            border-radius: var(--radius-sm);
            margin-top: 25px;
            border: 1px solid rgba(124, 58, 237, 0.3);
            backdrop-filter: blur(10px);
        }
        
        .player-id-label {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .player-id-value {
            color: var(--gold);
            font-weight: 700;
            font-family: 'JetBrains Mono', 'Cascadia Code', monospace;
            font-size: 1rem;
            letter-spacing: 0.5px;
            word-break: break-all;
        }
        
        .auth-btn {
            padding: 16px 30px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            margin-top: 20px;
            box-shadow: 
                0 8px 25px rgba(124, 58, 237, 0.4),
                0 2px 4px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 280px;
            min-height: 50px;
        }
        
        .auth-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: 0.5s;
        }
        
        .auth-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 12px 30px rgba(124, 58, 237, 0.6),
                0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .auth-btn:active {
            transform: translateY(-1px);
        }
        
        .auth-btn:hover::before {
            left: 100%;
        }
        
        .continue-btn {
            background: linear-gradient(135deg, var(--accent) 0%, #B45309 100%) !important;
        }
        
        /* ОСНОВНОЙ ИНТЕРФЕЙС */
        #gameContainer {
            display: none;
            min-height: 100vh;
            padding-top: 140px;
        }
        
        /* ХЕДЕР */
        .compact-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.98) 0%, 
                rgba(10, 15, 28, 0.98) 100%);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            border-bottom: 1px solid rgba(124, 58, 237, 0.3);
            height: 70px;
            backdrop-filter: blur(20px);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
            box-shadow: 
                0 4px 15px rgba(124, 58, 237, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .logo-text {
            font-weight: 900;
            font-size: 1.4rem;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
        }
        
        /* РЕСУРСЫ */
        .resources-container {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: flex-end;
        }
        
        .gold-display {
            background: linear-gradient(135deg, 
                rgba(251, 191, 36, 0.2) 0%, 
                rgba(245, 158, 11, 0.1) 100%);
            padding: 10px 15px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid rgba(251, 191, 36, 0.3);
            min-width: 140px;
            backdrop-filter: blur(10px);
            box-shadow: 
                0 4px 12px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .gold-icon {
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, 
                var(--gold) 0%, 
                #F59E0B 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            color: white;
            box-shadow: 
                0 3px 10px rgba(251, 191, 36, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .gold-info {
            flex: 1;
            min-width: 0;
        }
        
        .gold-amount {
            font-size: 1.2rem;
            font-weight: 800;
            color: var(--gold);
            line-height: 1.2;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .gold-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .energy-display {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 140px;
        }
        
        .energy-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .energy-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .energy-value {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--energy);
            font-family: monospace;
        }
        
        .energy-bar {
            height: 8px;
            background: rgba(30, 41, 59, 0.5);
            border-radius: 4px;
            overflow: hidden;
            border: 1px solid rgba(59, 130, 246, 0.2);
            position: relative;
        }
        
        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--energy) 0%, 
                #60A5FA 100%);
            border-radius: 4px;
            transition: width 0.3s ease-out;
            position: relative;
        }
        
        .energy-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.15) 50%, 
                transparent 100%);
            animation: energyShimmer 2s infinite linear;
        }
        
        /* НАВИГАЦИЯ */
        .navigation {
            position: fixed;
            top: 70px;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.95) 0%, 
                rgba(10, 15, 28, 0.95) 100%);
            padding: 10px;
            display: flex;
            gap: 8px;
            z-index: 999;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
        }
        
        .navigation::-webkit-scrollbar {
            display: none;
        }
        
        .nav-button {
            padding: 10px 16px;
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.08) 0%, 
                rgba(91, 33, 182, 0.04) 100%);
            border: 1px solid rgba(124, 58, 237, 0.15);
            border-radius: var(--radius-sm);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            min-height: 40px;
            min-width: fit-content;
        }
        
        .nav-button:active {
            transform: translateY(1px);
        }
        
        .nav-button:hover {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.15) 0%, 
                rgba(91, 33, 182, 0.08) 100%);
            border-color: rgba(124, 58, 237, 0.3);
            transform: translateY(-2px);
            color: rgba(255, 255, 255, 0.9);
        }
        
        .nav-button.active {
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            color: white;
            border-color: var(--primary);
            box-shadow: 
                0 4px 15px rgba(124, 58, 237, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        /* ОСНОВНОЙ КОНТЕНТ */
        .main-content {
            padding: 15px;
            padding-bottom: 100px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* КЛИКЕР */
        .clicker-section {
            margin-bottom: 20px;
        }
        
        .monster-container {
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.9) 0%, 
                rgba(10, 15, 28, 0.95) 100%);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            border: 2px solid rgba(124, 58, 237, 0.3);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            position: relative;
            overflow: hidden;
        }
        
        .monster-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                var(--primary), 
                var(--accent), 
                var(--gold), 
                var(--primary));
            background-size: 200% 100%;
            animation: gradientShift 3s linear infinite;
        }
        
        .monster-display {
            width: 250px;
            height: 250px;
            margin: 0 auto 20px;
            position: relative;
            cursor: pointer;
            touch-action: manipulation;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .monster {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border-radius: 50%;
            position: relative;
            transition: transform 0.1s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 20px 40px rgba(124, 58, 237, 0.4),
                inset 0 4px 12px rgba(255, 255, 255, 0.1);
            border: 10px solid rgba(15, 23, 42, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            color: white;
            overflow: hidden;
            -webkit-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            cursor: pointer;
        }
        
        .monster::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            right: -50%;
            bottom: -50%;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255, 255, 255, 0.08) 50%, 
                transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        .monster:active {
            transform: scale(0.95);
            box-shadow: 
                0 10px 25px rgba(124, 58, 237, 0.6),
                inset 0 4px 12px rgba(255, 255, 255, 0.2);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.15) 0%, 
                rgba(91, 33, 182, 0.1) 100%);
            border-radius: var(--radius-sm);
            padding: 15px;
            border: 1px solid rgba(124, 58, 237, 0.2);
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            border-color: rgba(124, 58, 237, 0.4);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--gold);
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* АКТИВНЫЕ БАФФЫ */
        .active-buffs-container {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.1) 0%, 
                rgba(30, 64, 175, 0.05) 100%);
            border-radius: var(--radius-sm);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .active-buffs-title {
            font-size: 1rem;
            font-weight: 700;
            color: var(--energy);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .active-buffs-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .buff-tag {
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.2) 0%, 
                rgba(30, 64, 175, 0.1) 100%);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: rgba(255, 255, 255, 0.9);
        }
        
        /* БИЗНЕСЫ */
        .businesses-section {
            margin-top: 30px;
        }
        
        .section-title {
            font-size: 1.7rem;
            font-weight: 800;
            color: white;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-title::after {
            content: '';
            flex: 1;
            height: 2px;
            background: linear-gradient(90deg, 
                rgba(124, 58, 237, 0.5), 
                transparent);
        }
        
        .businesses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 20px;
        }
        
        .business-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 20px;
            border: 1px solid rgba(124, 58, 237, 0.25);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .business-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                var(--primary), 
                var(--accent));
        }
        
        .business-card:hover {
            border-color: rgba(124, 58, 237, 0.5);
            transform: translateY(-5px);
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.2),
                0 0 0 1px rgba(124, 58, 237, 0.1);
        }
        
        .business-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .business-icon {
            width: 55px;
            height: 55px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            color: white;
            box-shadow: 
                0 5px 15px rgba(124, 58, 237, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .business-count {
            font-size: 2.2rem;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
        }
        
        .business-name {
            font-size: 1.3rem;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
        }
        
        .business-description {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .business-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 15px;
            padding: 15px;
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.1) 0%, 
                rgba(91, 33, 182, 0.05) 100%);
            border-radius: 10px;
            border: 1px solid rgba(124, 58, 237, 0.15);
        }
        
        .business-stat {
            text-align: center;
        }
        
        .business-stat-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 5px;
        }
        
        .business-stat-value {
            font-size: 1rem;
            font-weight: 700;
        }
        
        .business-income {
            color: var(--success);
        }
        
        .business-cost {
            color: var(--gold);
        }
        
        /* КНОПКИ */
        .action-button {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border: none;
            border-radius: var(--radius-sm);
            color: white;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
            min-height: 44px;
        }
        
        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: 0.5s;
        }
        
        .action-button:active {
            transform: translateY(1px);
        }
        
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 8px 20px rgba(124, 58, 237, 0.5),
                0 3px 6px rgba(0, 0, 0, 0.2);
        }
        
        .action-button:hover::before {
            left: 100%;
        }
        
        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .action-button:disabled:hover::before {
            left: -100%;
        }
        
        /* БУСТЫ */
        .boosts-section {
            margin-top: 30px;
        }
        
        .boosts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .boost-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 20px;
            border: 1px solid rgba(59, 130, 246, 0.25);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .boost-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, 
                var(--energy), 
                #1D4ED8);
        }
        
        .boost-card:hover {
            border-color: rgba(59, 130, 246, 0.5);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        
        .boost-icon {
            width: 65px;
            height: 65px;
            background: linear-gradient(135deg, 
                var(--energy) 0%, 
                #1D4ED8 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            margin: 0 auto 15px;
            color: white;
            box-shadow: 
                0 5px 15px rgba(59, 130, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .boost-name {
            font-size: 1.2rem;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
        }
        
        .boost-description {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        /* СКИНЫ */
        .skins-section {
            margin-top: 30px;
        }
        
        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
        }
        
        .skin-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 20px;
            border: 2px solid;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
            user-select: none;
        }
        
        .skin-card:active {
            transform: translateY(2px) scale(0.98);
        }
        
        .skin-card.common {
            border-color: rgba(255, 255, 255, 0.2);
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.05) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .skin-card.rare {
            border-color: var(--skin-rare);
            background: linear-gradient(135deg, 
                rgba(6, 214, 160, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .skin-card.epic {
            border-color: var(--skin-epic);
            background: linear-gradient(135deg, 
                rgba(157, 78, 221, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .skin-card.legendary {
            border-color: var(--skin-legendary);
            background: linear-gradient(135deg, 
                rgba(255, 107, 53, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .skin-card.mythic {
            border-color: var(--skin-mythic);
            background: linear-gradient(135deg, 
                rgba(255, 0, 110, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            animation: mythicGlow 2s infinite alternate;
        }
        
        @keyframes mythicGlow {
            0% { box-shadow: 0 0 10px var(--skin-mythic); }
            100% { box-shadow: 0 0 30px var(--skin-mythic); }
        }
        
        .skin-card.owned {
            border-width: 3px;
            box-shadow: 0 0 15px currentColor;
        }
        
        .skin-card.equipped {
            border-width: 3px;
            box-shadow: 
                0 0 25px currentColor,
                inset 0 0 15px rgba(255, 255, 255, 0.1);
        }
        
        .skin-card:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
        }
        
        .skin-preview {
            width: 90px;
            height: 90px;
            border-radius: 18px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: white;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.1);
        }
        
        .skin-name {
            font-size: 1.1rem;
            font-weight: 800;
            color: white;
            margin-bottom: 6px;
        }
        
        .skin-rarity {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            padding: 5px 10px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .skin-card.common .skin-rarity {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
        }
        
        .skin-card.rare .skin-rarity {
            background: var(--skin-rare);
            color: rgba(0, 0, 0, 0.8);
        }
        
        .skin-card.epic .skin-rarity {
            background: var(--skin-epic);
            color: white;
        }
        
        .skin-card.legendary .skin-rarity {
            background: var(--skin-legendary);
            color: rgba(0, 0, 0, 0.8);
        }
        
        .skin-card.mythic .skin-rarity {
            background: var(--skin-mythic);
            color: white;
        }
        
        /* ПРОМОКОДЫ */
        .promo-section {
            margin-top: 30px;
        }
        
        .promo-container {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.15) 0%, 
                rgba(91, 33, 182, 0.1) 100%);
            border-radius: 18px;
            padding: 25px;
            border: 1px solid rgba(124, 58, 237, 0.3);
        }
        
        .promo-input-container {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            flex-direction: column;
        }
        
        .promo-input {
            flex: 1;
            padding: 14px 18px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: var(--radius-sm);
            color: white;
            font-size: 1rem;
            font-family: 'JetBrains Mono', monospace;
            transition: all 0.3s;
        }
        
        .promo-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }
        
        /* ФУТЕР */
        .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.95) 0%, 
                rgba(10, 15, 28, 0.95) 100%);
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .footer-info {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            flex: 1;
        }
        
        .footer-info strong {
            color: var(--accent);
        }
        
        .footer-actions {
            display: flex;
            gap: 12px;
        }
        
        .footer-button {
            padding: 8px 16px;
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: var(--radius-sm);
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            min-height: 36px;
            white-space: nowrap;
        }
        
        .footer-button:active {
            transform: translateY(1px);
        }
        
        .footer-button:hover {
            background: rgba(124, 58, 237, 0.2);
            color: white;
            border-color: rgba(124, 58, 237, 0.5);
        }
        
        /* НОТИФИКАЦИИ */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 320px;
            z-index: 9999;
        }
        
        .notification {
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.95) 0%, 
                rgba(10, 15, 28, 0.95) 100%);
            border-radius: var(--radius-sm);
            padding: 15px;
            margin-bottom: 10px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            transform: translateX(400px);
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            border-left-color: var(--success);
        }
        
        .notification.warning {
            border-left-color: var(--warning);
        }
        
        .notification.error {
            border-left-color: var(--danger);
        }
        
        .notification.info {
            border-left-color: var(--energy);
        }
        
        .notification-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 6px;
            color: white;
        }
        
        .notification-message {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        /* ДОСТИЖЕНИЯ */
        .achievements-section {
            margin-top: 30px;
        }
        
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }
        
        .achievement-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 15px;
            border: 2px solid;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
        }
        
        .achievement-card.locked {
            border-color: rgba(255, 255, 255, 0.1);
            opacity: 0.6;
        }
        
        .achievement-card.unlocked {
            border-color: var(--gold);
            background: linear-gradient(135deg, 
                rgba(251, 191, 36, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .achievement-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--purple-dark) 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
        }
        
        .achievement-card.unlocked .achievement-icon {
            background: linear-gradient(135deg, 
                var(--gold) 0%, 
                #F59E0B 100%);
        }
        
        .achievement-info {
            flex: 1;
        }
        
        .achievement-name {
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
            font-size: 1rem;
        }
        
        .achievement-desc {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .achievement-reward {
            color: var(--gold);
            font-weight: 700;
            font-size: 0.85rem;
        }
        
        /* ЛИДЕРБОРД */
        .leaderboard-section {
            margin-top: 30px;
        }
        
        .leaderboard-container {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 25px;
            border: 2px solid rgba(124, 58, 237, 0.3);
            overflow-x: auto;
        }
        
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        
        .leaderboard-table th {
            background: rgba(124, 58, 237, 0.2);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(124, 58, 237, 0.3);
            font-size: 0.9rem;
        }
        
        .leaderboard-table td {
            padding: 10px 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9rem;
        }
        
        .leaderboard-table tr:hover {
            background: rgba(124, 58, 237, 0.05);
        }
        
        .leaderboard-table tr.current-user {
            background: rgba(251, 191, 36, 0.1);
            border-left: 3px solid var(--gold);
        }
        
        .rank-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            font-weight: bold;
            margin-right: 8px;
            font-size: 0.9rem;
        }
        
        .rank-1 {
            background: linear-gradient(135deg, var(--gold), #F59E0B);
            color: black;
        }
        
        .rank-2 {
            background: linear-gradient(135deg, var(--platinum), #9CA3AF);
            color: black;
        }
        
        .rank-3 {
            background: linear-gradient(135deg, var(--accent), #B45309);
            color: black;
        }
        
        /* ЛУТБОКСЫ */
        .lootboxes-section {
            margin-top: 30px;
        }
        
        .lootboxes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .lootbox-card {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 18px;
            padding: 20px;
            border: 2px solid;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .lootbox-card.box {
            border-color: #F59E0B;
            background: linear-gradient(135deg, 
                rgba(245, 158, 11, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .lootbox-card.container {
            border-color: #3B82F6;
            background: linear-gradient(135deg, 
                rgba(59, 130, 246, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .lootbox-card.case {
            border-color: #7C3AED;
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.1) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
        }
        
        .lootbox-icon {
            width: 70px;
            height: 70px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            margin: 0 auto 15px;
            color: white;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
        }
        
        .lootbox-card.box .lootbox-icon {
            background: linear-gradient(135deg, 
                #F59E0B 0%, 
                #B45309 100%);
        }
        
        .lootbox-card.container .lootbox-icon {
            background: linear-gradient(135deg, 
                #3B82F6 0%, 
                #1D4ED8 100%);
        }
        
        .lootbox-card.case .lootbox-icon {
            background: linear-gradient(135deg, 
                #7C3AED 0%, 
                #5B21B6 100%);
        }
        
        .lootbox-name {
            font-size: 1.2rem;
            font-weight: 800;
            color: white;
            margin-bottom: 8px;
        }
        
        .lootbox-description {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .lootbox-chances {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            margin-bottom: 15px;
            text-align: left;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .chance-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }
        
        /* ИНВЕНТАРЬ */
        .inventory-section {
            margin-top: 30px;
        }
        
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .inventory-item {
            background: linear-gradient(135deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(15, 23, 42, 0.95) 100%);
            border-radius: 12px;
            padding: 12px;
            border: 1px solid rgba(124, 58, 237, 0.3);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .inventory-item:active {
            transform: translateY(2px);
        }
        
        .inventory-item:hover {
            transform: translateY(-2px);
            border-color: rgba(124, 58, 237, 0.5);
        }
        
        .inventory-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.75rem;
        }
        
        /* РУЛЕТКА */
        .roulette-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            transition: opacity 0.3s;
            padding: 20px;
        }
        
        .roulette-overlay.show {
            opacity: 1;
        }
        
        .roulette-container {
            background: linear-gradient(135deg, 
                rgba(15, 23, 42, 0.95) 0%, 
                rgba(10, 15, 28, 0.98) 100%);
            border-radius: var(--radius-lg);
            padding: 25px;
            width: 100%;
            max-width: 700px;
            border: 3px solid var(--primary);
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        .roulette-overlay.show .roulette-container {
            transform: scale(1);
        }
        
        .roulette-title {
            font-size: 1.7rem;
            font-weight: 900;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            background: linear-gradient(135deg, 
                var(--primary) 0%, 
                var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .roulette-slots {
            display: flex;
            overflow: hidden;
            height: 100px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 2px solid var(--primary);
            margin-bottom: 20px;
            position: relative;
        }
        
        .roulette-slots::after {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 3px;
            height: 100%;
            background: var(--danger);
            box-shadow: 0 0 15px var(--danger);
        }
        
        .roulette-slot {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: white;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.1s;
        }
        
        .roulette-prize {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.2) 0%, 
                rgba(91, 33, 182, 0.1) 100%);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
            border: 2px solid rgba(124, 58, 237, 0.3);
            display: none;
        }
        
        .roulette-prize.show {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .prize-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }
        
        .prize-name {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--gold);
            margin-bottom: 8px;
        }
        
        .prize-description {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        /* АНИМАЦИИ */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
        
        @keyframes energyShimmer {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }
        
        @keyframes gradientShift {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 0.3;
                transform: scale(1);
            }
            50% {
                opacity: 0.6;
                transform: scale(1.1);
            }
        }
        
        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-40px) scale(1.2);
                opacity: 0;
            }
        }
        
        @keyframes clickEffect {
            0% {
                transform: scale(0);
                opacity: 1;
                border-width: 3px;
            }
            100% {
                transform: scale(2);
                opacity: 0;
                border-width: 1px;
            }
        }
        
        @keyframes particleFloat {
            0% {
                transform: translateY(0) scale(0);
                opacity: 1;
            }
            50% {
                transform: translateY(-25px) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) scale(0.5);
                opacity: 0;
            }
        }
        
        /* МОБИЛЬНАЯ АДАПТАЦИЯ */
        @media (max-width: 768px) {
            .auth-title h1 {
                font-size: 2rem;
            }
            
            .auth-btn {
                padding: 14px 20px;
                font-size: 1rem;
            }
            
            .compact-header {
                flex-direction: column;
                height: auto;
                padding: 10px;
                gap: 10px;
                position: fixed;
                top: 0;
            }
            
            .logo-container {
                width: 100%;
                justify-content: center;
            }
            
            .resources-container {
                width: 100%;
                justify-content: space-between;
                gap: 8px;
            }
            
            .gold-display,
            .energy-display {
                min-width: 48%;
                padding: 8px 10px;
            }
            
            .gold-icon, .energy-icon {
                width: 30px;
                height: 30px;
                font-size: 1rem;
            }
            
            .gold-amount {
                font-size: 1.1rem;
            }
            
            .navigation {
                top: 120px;
                padding: 8px;
                gap: 5px;
            }
            
            .nav-button {
                padding: 8px 10px;
                font-size: 0.8rem;
                gap: 5px;
                min-height: 36px;
            }
            
            #gameContainer {
                padding-top: 130px;
            }
            
            .main-content {
                padding: 10px;
                padding-bottom: 120px;
            }
            
            .monster-display {
                width: 200px;
                height: 200px;
            }
            
            .monster {
                font-size: 3.5rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .stat-card {
                padding: 12px;
            }
            
            .stat-value {
                font-size: 1.3rem;
            }
            
            .businesses-grid,
            .boosts-grid {
                grid-template-columns: 1fr;
            }
            
            .business-card {
                padding: 15px;
            }
            
            .skins-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
            
            .skin-card {
                padding: 15px;
            }
            
            .skin-preview {
                width: 70px;
                height: 70px;
                font-size: 1.8rem;
            }
            
            .footer {
                flex-direction: column;
                gap: 10px;
                text-align: center;
                padding: 10px;
                position: fixed;
                bottom: 0;
            }
            
            .footer-info {
                font-size: 0.75rem;
                text-align: center;
            }
            
            .footer-actions {
                width: 100%;
                justify-content: center;
            }
            
            .notification-container {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
                top: 10px;
            }
            
            .notification {
                width: 100%;
            }
            
            .achievements-grid {
                grid-template-columns: 1fr;
            }
            
            .leaderboard-table {
                font-size: 0.75rem;
            }
            
            .leaderboard-table th,
            .leaderboard-table td {
                padding: 6px 8px;
            }
            
            .lootboxes-grid {
                grid-template-columns: 1fr;
            }
            
            .roulette-container {
                padding: 15px;
            }
            
            .inventory-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .auth-container {
                padding: 20px 15px;
            }
            
            .auth-title h1 {
                font-size: 1.8rem;
            }
            
            .monster-display {
                width: 180px;
                height: 180px;
            }
            
            .monster {
                font-size: 3rem;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 6px;
            }
            
            .stat-value {
                font-size: 1.1rem;
            }
            
            .businesses-grid {
                grid-template-columns: 1fr;
            }
            
            .skins-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 8px;
            }
            
            .skin-card {
                padding: 12px;
            }
            
            .skin-preview {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .inventory-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* ЭФФЕКТЫ КЛИКА */
        .click-effect {
            position: absolute;
            width: 0;
            height: 0;
            border: 3px solid var(--energy);
            border-radius: 50%;
            animation: clickEffect 0.5s forwards;
            pointer-events: none;
            z-index: 99;
        }
        
        .money-popup {
            position: absolute;
            color: var(--gold);
            font-weight: 900;
            font-size: 1.2rem;
            pointer-events: none;
            z-index: 100;
            animation: floatUp 1s forwards;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.5),
                0 0 10px rgba(251, 191, 36, 0.5);
        }
        
        .critical-popup {
            position: absolute;
            color: var(--danger);
            font-weight: 900;
            font-size: 1.5rem;
            pointer-events: none;
            z-index: 100;
            animation: floatUp 1s forwards;
            text-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.5),
                0 0 15px rgba(239, 68, 68, 0.7);
        }
        
        .particle-effect {
            position: absolute;
            font-weight: 900;
            font-size: 1rem;
            pointer-events: none;
            z-index: 98;
            animation: particleFloat 0.8s forwards;
        }
        
        /* ПРОГРЕСС БАР */
        .xp-progress {
            height: 6px;
            background: rgba(124, 58, 237, 0.2);
            border-radius: 3px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .xp-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transition: width 0.5s ease;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- СНЕЖИНКИ -->
    <div id="snowflakes"></div>
    
    <!-- АВТОРИЗАЦИЯ -->
    <div id="authScreen">
        <div class="auth-container">
            <div class="auth-title">
                <h1><i class="fas fa-dragon"></i> MONSTORCLIK</h1>
            </div>
            
            <div class="auth-subtitle">
                Продвинутый кликер с уникальным движком<br>
                Система анти-чита, бусты, скины и многое другое
            </div>
            
            <!-- Кнопка продолжить появится динамически -->
            
            <button class="auth-btn" id="startBtn">
                <i class="fas fa-play-circle"></i> НАЧАТЬ ИГРУ
            </button>
            
            <div class="player-id">
                <div class="player-id-label">Ваш уникальный ID:</div>
                <div class="player-id-value" id="playerId">Загрузка...</div>
            </div>
        </div>
    </div>
    
    <!-- РУЛЕТКА -->
    <div id="rouletteOverlay" class="roulette-overlay">
        <div class="roulette-container">
            <div class="roulette-title" id="rouletteTitle">Открытие лутбокса</div>
            <div class="roulette-slots" id="rouletteSlots">
                <div class="roulette-slot">🎁</div>
                <div class="roulette-slot">💰</div>
                <div class="roulette-slot">💎</div>
                <div class="roulette-slot">👑</div>
                <div class="roulette-slot">🔥</div>
                <div class="roulette-slot">✨</div>
                <div class="roulette-slot">⚡</div>
                <div class="roulette-slot">🌟</div>
            </div>
            
            <div class="roulette-prize" id="roulettePrize">
                <div class="prize-icon" id="prizeIcon">🎁</div>
                <div class="prize-name" id="prizeName">Приз!</div>
                <div class="prize-description" id="prizeDescription">Вы выиграли награду!</div>
            </div>
            
            <button class="action-button" id="spinButton">
                <i class="fas fa-redo"></i> Крутить рулетку
            </button>
            
            <button class="action-button" id="closeRoulette" style="margin-top: 10px; background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);">
                <i class="fas fa-times"></i> Закрыть
            </button>
        </div>
    </div>
    
    <!-- ОСНОВНОЙ ИНТЕРФЕЙС -->
    <div id="gameContainer">
        <!-- ХЕДЕР -->
        <header class="compact-header">
            <div class="logo-container">
                <div class="logo-icon">
                    <i class="fas fa-dragon"></i>
                </div>
                <div class="logo-text">MONSTORCLIK</div>
            </div>
            
            <div class="resources-container">
                <div class="gold-display">
                    <div class="gold-icon">
                        <i class="fas fa-coins"></i>
                    </div>
                    <div class="gold-info">
                        <div class="gold-amount" id="goldAmount">0</div>
                        <div class="gold-label">Gold</div>
                    </div>
                </div>
                
                <div class="energy-display">
                    <div class="energy-info">
                        <div class="energy-label">
                            <i class="fas fa-bolt"></i> Энергия:
                        </div>
                        <div class="energy-value" id="energyValue">100/100</div>
                    </div>
                    <div class="energy-bar">
                        <div class="energy-fill" id="energyFill"></div>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- НАВИГАЦИЯ -->
        <nav class="navigation">
            <button class="nav-button active" data-tab="clicker">
                <i class="fas fa-fist-raised"></i> Кликер
            </button>
            <button class="nav-button" data-tab="businesses">
                <i class="fas fa-building"></i> Бизнесы
            </button>
            <button class="nav-button" data-tab="boosts">
                <i class="fas fa-rocket"></i> Бусты
            </button>
            <button class="nav-button" data-tab="skins">
                <i class="fas fa-palette"></i> Скины
            </button>
            <button class="nav-button" data-tab="lootboxes">
                <i class="fas fa-gift"></i> Лутбоксы
            </button>
            <button class="nav-button" data-tab="inventory">
                <i class="fas fa-box"></i> Инвентарь
            </button>
            <button class="nav-button" data-tab="leaderboard">
                <i class="fas fa-trophy"></i> Лидерборд
            </button>
            <button class="nav-button" data-tab="achievements">
                <i class="fas fa-medal"></i> Достижения
            </button>
        </nav>
        
        <!-- ОСНОВНОЙ КОНТЕНТ -->
        <main class="main-content" id="mainContent">
            <!-- Контент будет загружаться динамически -->
        </main>
        
        <!-- ФУТЕР -->
        <footer class="footer">
            <div class="footer-info">
                <strong>MONSTORCLIK</strong> © 2024 | Уровень: <span id="currentLevel">1</span> | Gold: <span id="footerGold">0</span> | CPS: <span id="cpsCounter">0</span>
            </div>
            
            <div class="footer-actions">
                <button class="footer-button" id="saveGameBtn">
                    <i class="fas fa-save"></i> Сохранить
                </button>
                <button class="footer-button" id="resetGameBtn">
                    <i class="fas fa-redo"></i> Сбросить
                </button>
            </div>
        </footer>
    </div>
    
    <!-- УВЕДОМЛЕНИЯ -->
    <div class="notification-container" id="notificationContainer"></div>

    <script>
        // ============ ДВИЖОК ИГРЫ ============
        class MonstorClickEngine {
            constructor() {
                // Оптимизация: ограничиваем максимальный CPS для детекции читов
                this.maxCPS = 30;
                this.clickHistory = [];
                this.lastClickTime = 0;
                this.isBlocked = false;
                this.blockTimer = 0;
                this.lastClickPositions = [];
                this.maxSamePositionClicks = 15;
                this.cps = 0;
                this.clickTimes = [];
                
                // Улучшенная система анти-чита
                this.patternDetection = {
                    lastPatterns: [],
                    suspiciousPatterns: 0,
                    lastPatternTime: 0
                };
                
                // Игровые данные
                this.gameData = {
                    playerId: this.generatePlayerId(),
                    nickname: 'Игрок_' + Math.floor(Math.random() * 1000),
                    gold: 0,
                    totalGold: 0,
                    totalClicks: 0,
                    clickPower: 1,
                    level: 1,
                    experience: 0,
                    maxExperience: 1000,
                    energy: 100,
                    maxEnergy: 100,
                    energyRegen: 0.5,
                    energyCost: 0.1,
                    businesses: {},
                    skins: ['default'],
                    equippedSkin: 'default',
                    lootboxes: {
                        box: 0,
                        container: 0,
                        case: 0
                    },
                    inventory: [],
                    promoUsed: [],
                    achievements: [],
                    stats: {
                        sessionStart: Date.now(),
                        totalTime: 0,
                        maxClickStreak: 0,
                        currentStreak: 0,
                        criticalHits: 0,
                        totalBusinesses: 0,
                        skinsUnlocked: 1,
                        lootboxesOpened: 0,
                        totalEarned: 0
                    },
                    activeBoosts: [],
                    seasonalEvent: {
                        active: true,
                        name: "Зимняя сказка",
                        multiplier: 1.5,
                        endTime: Date.now() + (7 * 24 * 60 * 60 * 1000)
                    }
                };
                
                // Достижения
                this.achievementsData = {
                    'first_click': {
                        id: 'first_click',
                        name: 'Первый шаг',
                        description: 'Сделать первый клик',
                        reward: 100,
                        condition: (game) => game.totalClicks >= 1,
                        icon: 'fa-mouse-pointer'
                    },
                    'gold_collector': {
                        id: 'gold_collector',
                        name: 'Коллекционер золота',
                        description: 'Заработать 10,000 Gold',
                        reward: 1000,
                        condition: (game) => game.totalGold >= 10000,
                        icon: 'fa-coins'
                    },
                    'click_master': {
                        id: 'click_master',
                        name: 'Мастер кликов',
                        description: 'Сделать 1000 кликов',
                        reward: 5000,
                        condition: (game) => game.totalClicks >= 1000,
                        icon: 'fa-fist-raised'
                    },
                    'business_tycoon': {
                        id: 'business_tycoon',
                        name: 'Бизнес-магнат',
                        description: 'Купить 50 бизнесов',
                        reward: 10000,
                        condition: (game) => game.stats.totalBusinesses >= 50,
                        icon: 'fa-building'
                    },
                    'skin_collector': {
                        id: 'skin_collector',
                        name: 'Коллекционер скинов',
                        description: 'Разблокировать 5 скинов',
                        reward: 5000,
                        condition: (game) => game.stats.skinsUnlocked >= 5,
                        icon: 'fa-palette'
                    },
                    'critical_expert': {
                        id: 'critical_expert',
                        name: 'Эксперт по критам',
                        description: 'Сделать 100 критических ударов',
                        reward: 7500,
                        condition: (game) => game.stats.criticalHits >= 100,
                        icon: 'fa-bolt'
                    },
                    'level_20': {
                        id: 'level_20',
                        name: 'Ветеран',
                        description: 'Достигнуть 20 уровня',
                        reward: 20000,
                        condition: (game) => game.level >= 20,
                        icon: 'fa-trophy'
                    },
                    'rich_man': {
                        id: 'rich_man',
                        name: 'Миллионер',
                        description: 'Накопить 1,000,000 Gold',
                        reward: 50000,
                        condition: (game) => game.totalGold >= 1000000,
                        icon: 'fa-crown'
                    },
                    'lootbox_opener': {
                        id: 'lootbox_opener',
                        name: 'Коллекционер лутбоксов',
                        description: 'Открыть 10 лутбоксов',
                        reward: 15000,
                        condition: (game) => game.stats.lootboxesOpened >= 10,
                        icon: 'fa-gift'
                    }
                };
                
                // Промокоды
                this.promoCodes = {
                    'WELCOME1000': {
                        code: 'WELCOME1000',
                        reward: { type: 'gold', amount: 1000 },
                        description: '1000 Gold',
                        hidden: true
                    },
                    'DOUBLEPOWER': {
                        code: 'DOUBLEPOWER',
                        reward: { type: 'boost', id: 'double_click', duration: 120 },
                        description: 'x2 сила клика на 2 минуты',
                        hidden: true
                    },
                    'LEGENDARYBOX': {
                        code: 'LEGENDARYBOX',
                        reward: { type: 'gold', amount: 5000 },
                        description: '5000 Gold',
                        hidden: true
                    }
                };
                
                // Лутбоксы
                this.lootboxesData = {
                    'box': {
                        id: 'box',
                        name: 'Обычный бокс',
                        description: 'Дешевый бокс с малыми шансами на хорошие награды',
                        price: 5000,
                        icon: 'fas fa-box',
                        rewards: [
                            { type: 'gold', value: 100, chance: 40 },
                            { type: 'gold', value: 500, chance: 25 },
                            { type: 'gold', value: 1000, chance: 15 },
                            { type: 'boost', id: 'small_energy', chance: 10 },
                            { type: 'skin', id: 'warrior', chance: 5 },
                            { type: 'skin', id: 'mage', chance: 3 },
                            { type: 'skin', id: 'void', chance: 2 }
                        ]
                    },
                    'container': {
                        id: 'container',
                        name: 'Контейнер',
                        description: 'Лучше чем бокс, больше шансов на хорошие награды',
                        price: 15000,
                        icon: 'fas fa-box-open',
                        rewards: [
                            { type: 'gold', value: 500, chance: 30 },
                            { type: 'gold', value: 2000, chance: 25 },
                            { type: 'gold', value: 5000, chance: 15 },
                            { type: 'boost', id: 'medium_energy', chance: 10 },
                            { type: 'boost', id: 'luck_boost', chance: 8 },
                            { type: 'skin', id: 'king', chance: 6 },
                            { type: 'skin', id: 'dragon', chance: 4 },
                            { type: 'skin', id: 'cyber', chance: 2 }
                        ]
                    },
                    'case': {
                        id: 'case',
                        name: 'Кейс',
                        description: 'Могут выпасть любые скины, но маленький шанс на редкие',
                        price: 50000,
                        icon: 'fas fa-briefcase',
                        rewards: [
                            { type: 'gold', value: 5000, chance: 25 },
                            { type: 'gold', value: 10000, chance: 20 },
                            { type: 'boost', id: 'large_energy', chance: 15 },
                            { type: 'boost', id: 'gold_rain', chance: 12 },
                            { type: 'skin', id: 'snowman', chance: 10 },
                            { type: 'skin', id: 'phoenix', chance: 8 },
                            { type: 'skin', id: 'void', chance: 5 },
                            { type: 'boost', id: 'permanent_multiplier', chance: 5 }
                        ]
                    }
                };
                
                // Лидерборд
                this.leaderboard = [];
                
                // Инициализация
                this.init();
            }
            
            generatePlayerId() {
                const timestamp = Date.now().toString(36);
                const random = Math.random().toString(36).substring(2, 8);
                return `MC_${timestamp}_${random}`.toUpperCase();
            }
            
            init() {
                this.setupGameData();
                this.setupEventListeners();
                this.startGameLoop();
                this.loadGame();
                this.createSnowflakes();
                this.generateLeaderboard();
                
                // Показываем ID игрока
                const playerIdElement = document.getElementById('playerId');
                if (playerIdElement) {
                    playerIdElement.textContent = this.gameData.playerId;
                }
                
                console.log('MONSTORCLIK инициализирован!');
            }
            
            setupGameData() {
                // Бизнесы
                this.gameData.businesses = {
                    'gold_mine': {
                        id: 'gold_mine',
                        name: 'Золотой рудник',
                        description: 'Медленная добыча золота',
                        level: 0,
                        baseIncome: 0.5,
                        income: 0.5,
                        baseCost: 1000,
                        cost: 1000,
                        multiplier: 1,
                        icon: 'fas fa-mountain',
                        totalIncome: 0,
                        unlocked: true
                    },
                    'farm': {
                        id: 'farm',
                        name: 'Ферма',
                        description: 'Производство золота',
                        level: 0,
                        baseIncome: 2,
                        income: 2,
                        baseCost: 5000,
                        cost: 5000,
                        multiplier: 1,
                        icon: 'fas fa-tractor',
                        totalIncome: 0,
                        unlocked: false
                    },
                    'factory': {
                        id: 'factory',
                        name: 'Завод',
                        description: 'Быстрое производство',
                        level: 0,
                        baseIncome: 10,
                        income: 10,
                        baseCost: 25000,
                        cost: 25000,
                        multiplier: 1,
                        icon: 'fas fa-industry',
                        totalIncome: 0,
                        unlocked: false
                    },
                    'laboratory': {
                        id: 'laboratory',
                        name: 'Лаборатория',
                        description: 'Исследовательский центр',
                        level: 0,
                        baseIncome: 50,
                        income: 50,
                        baseCost: 100000,
                        cost: 100000,
                        multiplier: 1,
                        icon: 'fas fa-flask',
                        totalIncome: 0,
                        unlocked: false
                    },
                    'spaceport': {
                        id: 'spaceport',
                        name: 'Космопорт',
                        description: 'Межгалактическая добыча',
                        level: 0,
                        baseIncome: 250,
                        income: 250,
                        baseCost: 1000000,
                        cost: 1000000,
                        multiplier: 1,
                        icon: 'fas fa-rocket',
                        totalIncome: 0,
                        unlocked: false
                    }
                };
                
                // Скины
                this.gameData.skinsData = {
                    'default': {
                        id: 'default',
                        name: 'Стандартный',
                        rarity: 'common',
                        multiplier: 1,
                        price: 0,
                        icon: 'fas fa-dragon',
                        color: '#7C3AED',
                        aura: null
                    },
                    'warrior': {
                        id: 'warrior',
                        name: 'Воин',
                        rarity: 'rare',
                        multiplier: 1.2,
                        price: 5000,
                        icon: 'fas fa-helmet-battle',
                        color: '#DC2626',
                        aura: '#DC2626'
                    },
                    'mage': {
                        id: 'mage',
                        name: 'Маг',
                        rarity: 'rare',
                        multiplier: 1.3,
                        price: 15000,
                        icon: 'fas fa-hat-wizard',
                        color: '#8B5CF6',
                        aura: '#8B5CF6'
                    },
                    'king': {
                        id: 'king',
                        name: 'Король',
                        rarity: 'epic',
                        multiplier: 1.6,
                        price: 50000,
                        icon: 'fas fa-crown',
                        color: '#FBBF24',
                        aura: '#FBBF24'
                    },
                    'dragon': {
                        id: 'dragon',
                        name: 'Дракон',
                        rarity: 'legendary',
                        multiplier: 2.0,
                        price: 250000,
                        icon: 'fas fa-dragon',
                        color: '#FF6B35',
                        aura: '#FF6B35'
                    },
                    'cyber': {
                        id: 'cyber',
                        name: 'Кибер',
                        rarity: 'legendary',
                        multiplier: 2.2,
                        price: 500000,
                        icon: 'fas fa-robot',
                        color: '#06D6A0',
                        aura: '#06D6A0'
                    },
                    'phoenix': {
                        id: 'phoenix',
                        name: 'Феникс',
                        rarity: 'mythic',
                        multiplier: 3.0,
                        price: 2000000,
                        icon: 'fas fa-fire',
                        color: '#FF006E',
                        aura: '#FF006E'
                    },
                    'void': {
                        id: 'void',
                        name: 'Пустота',
                        rarity: 'mythic',
                        multiplier: 3.5,
                        price: 5000000,
                        icon: 'fas fa-meteor',
                        color: '#000000',
                        aura: '#7C3AED'
                    },
                    'snowman': {
                        id: 'snowman',
                        name: 'Снеговик',
                        rarity: 'epic',
                        multiplier: 1.8,
                        price: 75000,
                        icon: 'fas fa-snowman',
                        color: '#60A5FA',
                        aura: '#60A5FA'
                    }
                };
            }
            
            createSnowflakes() {
                const snowflakes = ['❄', '❅', '❆', '✻', '✼', '✦'];
                const container = document.getElementById('snowflakes');
                
                if (!container) return;
                
                for (let i = 0; i < 20; i++) {
                    const snowflake = document.createElement('div');
                    snowflake.className = 'snowflake';
                    snowflake.innerHTML = snowflakes[Math.floor(Math.random() * snowflakes.length)];
                    
                    const left = Math.random() * 100;
                    const size = Math.random() * 1.2 + 0.5;
                    const duration = Math.random() * 10 + 5;
                    const delay = Math.random() * 5;
                    
                    snowflake.style.left = left + 'vw';
                    snowflake.style.fontSize = size + 'rem';
                    snowflake.style.animationDuration = duration + 's';
                    snowflake.style.animationDelay = delay + 's';
                    
                    container.appendChild(snowflake);
                    
                    setTimeout(() => {
                        if (snowflake.parentNode) {
                            snowflake.remove();
                        }
                    }, (duration + delay) * 1000);
                }
            }
            
            setupEventListeners() {
                // Клик по монстру
                const handleMonsterClick = (e) => {
                    if (e.type === 'touchstart') {
                        e.preventDefault();
                    }
                    this.handleClick(e);
                    
                    // Анимация нажатия для мобильных
                    const monster = document.querySelector('.monster');
                    if (monster) {
                        monster.classList.add('touch-active');
                        setTimeout(() => {
                            monster.classList.remove('touch-active');
                        }, 150);
                    }
                };
                
                // Навигация
                document.addEventListener('click', (e) => {
                    const navBtn = e.target.closest('.nav-button');
                    if (navBtn) {
                        const tab = navBtn.dataset.tab;
                        this.switchTab(tab);
                    }
                });
                
                // Кнопки
                const startBtn = document.getElementById('startBtn');
                if (startBtn) {
                    startBtn.addEventListener('click', () => this.startGame());
                }
                
                const saveBtn = document.getElementById('saveGameBtn');
                if (saveBtn) {
                    saveBtn.addEventListener('click', () => this.saveGame());
                }
                
                const resetBtn = document.getElementById('resetGameBtn');
                if (resetBtn) {
                    resetBtn.addEventListener('click', () => this.resetGame());
                }
                
                const closeRoulette = document.getElementById('closeRoulette');
                if (closeRoulette) {
                    closeRoulette.addEventListener('click', () => this.hideRoulette());
                }
                
                const spinButton = document.getElementById('spinButton');
                if (spinButton) {
                    spinButton.addEventListener('click', () => this.spinRoulette());
                }
                
                // Добавляем обработчики для монстра после загрузки контента
                this.attachMonsterListeners = () => {
                    const monsterDisplay = document.querySelector('.monster-display');
                    const monster = document.querySelector('.monster');
                    
                    if (monsterDisplay) {
                        monsterDisplay.addEventListener('mousedown', handleMonsterClick);
                        monsterDisplay.addEventListener('touchstart', handleMonsterClick, { passive: false });
                    }
                    
                    if (monster) {
                        monster.addEventListener('mousedown', handleMonsterClick);
                        monster.addEventListener('touchstart', handleMonsterClick, { passive: false });
                    }
                };
            }
            
            handleClick(event) {
                if (this.isBlocked) {
                    this.showNotification('Вы заблокированы за читерство!', 'error');
                    return;
                }
                
                const now = Date.now();
                const timeSinceLastClick = now - this.lastClickTime;
                
                if (timeSinceLastClick < 10) {
                    this.patternDetection.suspiciousPatterns++;
                } else {
                    this.patternDetection.suspiciousPatterns = Math.max(0, this.patternDetection.suspiciousPatterns - 1);
                }
                
                if (this.patternDetection.suspiciousPatterns > 50) {
                    this.blockCheater('Обнаружен автокликер! Слишком быстрые клики.');
                    return;
                }
                
                this.lastClickTime = now;
                this.clickTimes.push(now);
                
                const oneSecondAgo = now - 1000;
                this.clickTimes = this.clickTimes.filter(time => time > oneSecondAgo);
                this.cps = this.clickTimes.length;
                
                document.getElementById('cpsCounter').textContent = this.cps;
                
                if (this.gameData.energy < this.gameData.energyCost) {
                    this.showNotification('Недостаточно энергии! Отдохните немного.', 'warning');
                    return;
                }
                
                this.gameData.energy -= this.gameData.energyCost;
                
                let goldPerClick = this.gameData.clickPower;
                
                this.gameData.activeBoosts.forEach(boost => {
                    if (boost.type === 'click_power') {
                        goldPerClick *= boost.multiplier;
                    }
                });
                
                if (this.gameData.seasonalEvent.active) {
                    goldPerClick *= this.gameData.seasonalEvent.multiplier;
                }
                
                const skin = this.gameData.skinsData[this.gameData.equippedSkin];
                goldPerClick *= skin.multiplier;
                
                let isCritical = false;
                let criticalMultiplier = 2;
                let criticalChance = 0.05;
                
                this.gameData.activeBoosts.forEach(boost => {
                    if (boost.type === 'critical_chance') {
                        criticalChance = boost.chance;
                    }
                });
                
                if (Math.random() < criticalChance) {
                    goldPerClick *= criticalMultiplier;
                    isCritical = true;
                    this.gameData.stats.criticalHits++;
                }
                
                goldPerClick = Math.floor(goldPerClick);
                if (goldPerClick < 1) goldPerClick = 1;
                
                this.gameData.gold += goldPerClick;
                this.gameData.totalGold += goldPerClick;
                this.gameData.totalClicks++;
                this.gameData.stats.totalEarned += goldPerClick;
                
                this.gameData.experience += Math.floor(goldPerClick / 10);
                
                if (this.gameData.experience >= this.gameData.maxExperience) {
                    this.levelUp();
                }
                
                this.gameData.stats.currentStreak++;
                if (this.gameData.stats.currentStreak > this.gameData.stats.maxClickStreak) {
                    this.gameData.stats.maxClickStreak = this.gameData.stats.currentStreak;
                }
                
                this.checkAchievements();
                
                if (this.gameData.energy > 10) {
                    this.createClickEffects(event, goldPerClick, isCritical);
                }
                
                this.unlockBusinesses();
                
                this.updateUI();
                
                this.updateLeaderboard();
                
                if (this.gameData.totalClicks % 100 === 0) {
                    this.saveGame(false);
                }
            }
            
            createClickEffects(event, amount, isCritical) {
                const monster = document.querySelector('.monster-display') || document.querySelector('.monster');
                if (!monster) return;
                
                let clientX, clientY;
                
                if (event.type.includes('touch')) {
                    const touch = event.touches[0] || event.changedTouches[0];
                    clientX = touch.clientX;
                    clientY = touch.clientY;
                } else {
                    clientX = event.clientX;
                    clientY = event.clientY;
                }
                
                const rect = monster.getBoundingClientRect();
                const x = clientX - rect.left;
                const y = clientY - rect.top;
                
                const popup = document.createElement('div');
                popup.className = isCritical ? 'critical-popup' : 'money-popup';
                popup.textContent = '+' + amount;
                popup.style.left = x + 'px';
                popup.style.top = y + 'px';
                monster.appendChild(popup);
                setTimeout(() => popup.remove(), 1000);
            }
            
            unlockBusinesses() {
                Object.values(this.gameData.businesses).forEach(business => {
                    if (!business.unlocked) {
                        if (this.gameData.totalGold >= business.baseCost * 0.5) {
                            business.unlocked = true;
                            this.showNotification(`Разблокирован бизнес: ${business.name}!`, 'info');
                        }
                    }
                });
            }
            
            checkAchievements() {
                Object.values(this.achievementsData).forEach(achievement => {
                    if (!this.gameData.achievements.includes(achievement.id)) {
                        if (achievement.condition(this.gameData)) {
                            this.unlockAchievement(achievement);
                        }
                    }
                });
            }
            
            unlockAchievement(achievement) {
                this.gameData.achievements.push(achievement.id);
                this.gameData.gold += achievement.reward;
                
                this.showNotification(
                    `Достижение разблокировано: ${achievement.name}!<br>+${achievement.reward} Gold`,
                    'success'
                );
                
                if (this.currentTab === 'achievements') {
                    this.loadTabContent('achievements');
                }
            }
            
            blockCheater(reason) {
                if (this.isBlocked) return;
                
                this.isBlocked = true;
                this.blockTimer = 10;
                
                this.showNotification(`${reason} Блокировка на 10 секунд.`, 'error');
                
                const timerInterval = setInterval(() => {
                    this.blockTimer--;
                    if (this.blockTimer <= 0) {
                        clearInterval(timerInterval);
                        this.isBlocked = false;
                        this.clickHistory = [];
                        this.lastClickPositions = [];
                        this.patternDetection.suspiciousPatterns = 0;
                        this.showNotification('Блокировка снята. Играйте честно!', 'info');
                    }
                }, 1000);
            }
            
            switchTab(tab) {
                document.querySelectorAll('.nav-button').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
                this.currentTab = tab;
                this.loadTabContent(tab);
                
                // Привязываем обработчики кликов после загрузки контента
                setTimeout(() => this.attachMonsterListeners(), 100);
            }
            
            loadTabContent(tab) {
                const content = document.getElementById('mainContent');
                
                switch(tab) {
                    case 'clicker':
                        content.innerHTML = this.renderClicker();
                        this.updateMonsterAppearance();
                        break;
                    case 'businesses':
                        content.innerHTML = this.renderBusinesses();
                        break;
                    case 'boosts':
                        content.innerHTML = this.renderBoosts();
                        break;
                    case 'skins':
                        content.innerHTML = this.renderSkins();
                        break;
                    case 'lootboxes':
                        content.innerHTML = this.renderLootboxes();
                        break;
                    case 'inventory':
                        content.innerHTML = this.renderInventory();
                        break;
                    case 'leaderboard':
                        content.innerHTML = this.renderLeaderboard();
                        break;
                    case 'achievements':
                        content.innerHTML = this.renderAchievements();
                        break;
                }
                
                // Обновляем UI после загрузки контента
                this.updateUI();
            }
            
            renderClicker() {
                const skin = this.gameData.skinsData[this.gameData.equippedSkin];
                const progress = (this.gameData.experience / this.gameData.maxExperience * 100).toFixed(1);
                
                let activeBuffsHTML = '';
                const now = Date.now();
                const activeBoosts = this.gameData.activeBoosts.filter(boost => boost.expires > now);
                
                if (activeBoosts.length > 0) {
                    activeBuffsHTML = `
                        <div class="active-buffs-container">
                            <div class="active-buffs-title">
                                <i class="fas fa-bolt"></i> Активные баффы
                            </div>
                            <div class="active-buffs-grid">
                                ${activeBoosts.map(boost => `
                                    <div class="buff-tag">
                                        <i class="fas fa-${boost.icon}"></i>
                                        ${boost.name}: ${Math.ceil((boost.expires - now) / 1000)}с
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
                
                return `
                    <div class="clicker-section">
                        <div class="monster-container">
                            <div class="monster-display">
                                <div class="monster">
                                    <i class="${skin.icon}"></i>
                                </div>
                            </div>
                            
                            <div class="xp-progress">
                                <div class="xp-progress-fill" style="width: ${progress}%"></div>
                            </div>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value">${this.gameData.clickPower.toFixed(1)}</div>
                                    <div class="stat-label">Сила клика</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${this.gameData.totalClicks.toLocaleString()}</div>
                                    <div class="stat-label">Всего кликов</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${this.gameData.level}</div>
                                    <div class="stat-label">Уровень</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${progress}%</div>
                                    <div class="stat-label">Прогресс</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${this.formatNumber(this.gameData.totalGold)}</div>
                                    <div class="stat-label">Всего Gold</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${skin.name}</div>
                                    <div class="stat-label">Скин (x${skin.multiplier})</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${this.cps}</div>
                                    <div class="stat-label">CPS</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">${this.gameData.stats.criticalHits}</div>
                                    <div class="stat-label">Криты</div>
                                </div>
                            </div>
                            
                            ${activeBuffsHTML}
                            
                            <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                                <i class="fas fa-info-circle"></i> Энергия тратится: ${this.gameData.energyCost.toFixed(1)} за клик
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderBusinesses() {
                let businessesHTML = '';
                
                Object.values(this.gameData.businesses).forEach(business => {
                    if (!business.unlocked) return;
                    
                    const totalIncome = business.totalIncome.toFixed(1);
                    
                    businessesHTML += `
                        <div class="business-card">
                            <div class="business-header">
                                <div class="business-icon">
                                    <i class="${business.icon}"></i>
                                </div>
                                <div class="business-count">${business.level}</div>
                            </div>
                            <div class="business-name">${business.name}</div>
                            <div class="business-description">${business.description}</div>
                            <div class="business-stats">
                                <div class="business-stat">
                                    <div class="business-stat-label">Доход/сек</div>
                                    <div class="business-stat-value business-income">+${business.income.toFixed(1)}</div>
                                </div>
                                <div class="business-stat">
                                    <div class="business-stat-label">Стоимость</div>
                                    <div class="business-stat-value business-cost">${this.formatNumber(business.cost)}</div>
                                </div>
                                <div class="business-stat">
                                    <div class="business-stat-label">Куплено</div>
                                    <div class="business-stat-value">${business.level}</div>
                                </div>
                                <div class="business-stat">
                                    <div class="business-stat-label">Общий доход</div>
                                    <div class="business-stat-value">${this.formatNumber(totalIncome)}</div>
                                </div>
                            </div>
                            <button class="action-button" onclick="window.engine.buyBusiness('${business.id}')" 
                                    ${this.gameData.gold < business.cost ? 'disabled' : ''}>
                                <i class="fas fa-shopping-cart"></i> Купить (${business.level})
                            </button>
                        </div>
                    `;
                });
                
                return `
                    <div class="businesses-section">
                        <h2 class="section-title">
                            <i class="fas fa-building"></i> Бизнесы
                        </h2>
                        <div class="businesses-grid">
                            ${businessesHTML}
                        </div>
                        <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                            <i class="fas fa-exclamation-triangle"></i> Всего бизнесов: ${this.gameData.stats.totalBusinesses}
                        </div>
                    </div>
                `;
            }
            
            buyBusiness(businessId) {
                const business = this.gameData.businesses[businessId];
                if (!business) return;
                
                if (this.gameData.gold < business.cost) {
                    this.showNotification('Недостаточно Gold!', 'warning');
                    return;
                }
                
                this.gameData.gold -= business.cost;
                business.level++;
                this.gameData.stats.totalBusinesses++;
                
                business.income = business.baseIncome * business.level;
                business.cost = Math.floor(business.baseCost * Math.pow(1.5, business.level));
                
                this.showNotification(`Куплен ${business.name} (уровень ${business.level})! Доход: +${business.income.toFixed(1)}/сек`, 'success');
                this.updateUI();
                this.checkAchievements();
                this.saveGame();
            }
            
            renderBoosts() {
                return `
                    <div class="boosts-section">
                        <h2 class="section-title">
                            <i class="fas fa-rocket"></i> Бусты
                        </h2>
                        <div class="boosts-grid">
                            <div class="boost-card">
                                <div class="boost-icon">
                                    <i class="fas fa-fist-raised"></i>
                                </div>
                                <div class="boost-name">Двойной клик</div>
                                <div class="boost-description">Удваивает силу клика на 30 секунд</div>
                                <button class="action-button" onclick="window.engine.activateBoost('double_click')" 
                                        ${this.gameData.gold < 5000 ? 'disabled' : ''}>
                                    <i class="fas fa-bolt"></i> 5,000 Gold
                                </button>
                            </div>
                            
                            <div class="boost-card">
                                <div class="boost-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div class="boost-name">Энергетик</div>
                                <div class="boost-description">Восстанавливает 50 энергии</div>
                                <button class="action-button" onclick="window.engine.activateBoost('energy_boost')" 
                                        ${this.gameData.gold < 3000 ? 'disabled' : ''}>
                                    <i class="fas fa-battery-full"></i> 3,000 Gold
                                </button>
                            </div>
                            
                            <div class="boost-card">
                                <div class="boost-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="boost-name">Золотой дождь</div>
                                <div class="boost-description">Увеличивает доход бизнесов x2 на 60 секунд</div>
                                <button class="action-button" onclick="window.engine.activateBoost('gold_rain')" 
                                        ${this.gameData.gold < 10000 ? 'disabled' : ''}>
                                    <i class="fas fa-gift"></i> 10,000 Gold
                                </button>
                            </div>
                            
                            <div class="boost-card">
                                <div class="boost-icon">
                                    <i class="fas fa-gem"></i>
                                </div>
                                <div class="boost-name">Удача</div>
                                <div class="boost-description">Шанс крита 30% на 45 секунд</div>
                                <button class="action-button" onclick="window.engine.activateBoost('luck_boost')" 
                                        ${this.gameData.gold < 7500 ? 'disabled' : ''}>
                                    <i class="fas fa-star"></i> 7,500 Gold
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            activateBoost(boostType) {
                let cost, boostData;
                
                switch(boostType) {
                    case 'double_click':
                        cost = 5000;
                        if (this.gameData.gold < cost) {
                            this.showNotification('Недостаточно Gold!', 'warning');
                            return;
                        }
                        this.gameData.gold -= cost;
                        boostData = {
                            type: 'click_power',
                            multiplier: 2,
                            expires: Date.now() + 30000,
                            name: 'Двойной клик',
                            icon: 'fist-raised'
                        };
                        this.showNotification('Активирован Двойной клик! x2 сила клика на 30 секунд', 'success');
                        break;
                        
                    case 'energy_boost':
                        cost = 3000;
                        if (this.gameData.gold < cost) {
                            this.showNotification('Недостаточно Gold!', 'warning');
                            return;
                        }
                        this.gameData.gold -= cost;
                        this.gameData.energy = Math.min(this.gameData.maxEnergy, this.gameData.energy + 50);
                        this.showNotification('+50 энергии!', 'success');
                        return;
                        
                    case 'gold_rain':
                        cost = 10000;
                        if (this.gameData.gold < cost) {
                            this.showNotification('Недостаточно Gold!', 'warning');
                            return;
                        }
                        this.gameData.gold -= cost;
                        boostData = {
                            type: 'business_income',
                            multiplier: 2,
                            expires: Date.now() + 60000,
                            name: 'Золотой дождь',
                            icon: 'coins'
                        };
                        this.showNotification('Активирован Золотой дождь! x2 доход бизнесов на 60 секунд', 'success');
                        break;
                        
                    case 'luck_boost':
                        cost = 7500;
                        if (this.gameData.gold < cost) {
                            this.showNotification('Недостаточно Gold!', 'warning');
                            return;
                        }
                        this.gameData.gold -= cost;
                        boostData = {
                            type: 'critical_chance',
                            chance: 0.3,
                            expires: Date.now() + 45000,
                            name: 'Удача',
                            icon: 'gem'
                        };
                        this.showNotification('Активирована Удача! 30% шанс крита на 45 секунд', 'success');
                        break;
                }
                
                if (boostData) {
                    this.gameData.activeBoosts.push(boostData);
                    
                    setTimeout(() => {
                        this.gameData.activeBoosts = this.gameData.activeBoosts.filter(b => b !== boostData);
                        if (this.currentTab === 'clicker') {
                            this.loadTabContent('clicker');
                        }
                    }, boostData.expires - Date.now());
                }
                
                this.updateUI();
                this.saveGame();
            }
            
            renderSkins() {
                let skinsHTML = '';
                
                Object.values(this.gameData.skinsData).forEach(skin => {
                    const isOwned = this.gameData.skins.includes(skin.id);
                    const isEquipped = this.gameData.equippedSkin === skin.id;
                    
                    skinsHTML += `
                        <div class="skin-card ${skin.rarity} ${isOwned ? 'owned' : ''} ${isEquipped ? 'equipped' : ''}"
                             onclick="window.engine.handleSkinClick('${skin.id}')">
                            <div class="skin-preview" style="background: linear-gradient(135deg, ${skin.color} 0%, ${this.darkenColor(skin.color, 20)} 100%)">
                                <i class="${skin.icon}"></i>
                            </div>
                            <div class="skin-name">${skin.name}</div>
                            <div class="skin-rarity">
                                ${skin.rarity === 'common' ? 'Обычный' : 
                                 skin.rarity === 'rare' ? 'Редкий' : 
                                 skin.rarity === 'epic' ? 'Эпический' : 
                                 skin.rarity === 'legendary' ? 'Легендарный' : 'Мифический'}
                            </div>
                            <div style="margin: 10px 0; font-size: 0.9rem; color: rgba(255, 255, 255, 0.8)">
                                Множитель: x${skin.multiplier}
                            </div>
                            <div style="margin-bottom: 15px; font-size: 0.9rem; color: ${isEquipped ? '#10B981' : 
                                                                                     isOwned ? '#3B82F6' : 
                                                                                     '#FBBF24'}">
                                ${isEquipped ? 'Надет' : 
                                  isOwned ? 'Надеть' : 
                                  `${this.formatNumber(skin.price)} Gold`}
                            </div>
                        </div>
                    `;
                });
                
                return `
                    <div class="skins-section">
                        <h2 class="section-title">
                            <i class="fas fa-palette"></i> Скины
                        </h2>
                        <div class="skins-grid">
                            ${skinsHTML}
                        </div>
                        <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> Разблокировано скинов: ${this.gameData.skins.length}/9
                        </div>
                    </div>
                `;
            }
            
            handleSkinClick(skinId) {
                const skin = this.gameData.skinsData[skinId];
                if (!skin) return;
                
                if (this.gameData.skins.includes(skinId)) {
                    this.gameData.equippedSkin = skinId;
                    this.showNotification(`Надет скин "${skin.name}" (x${skin.multiplier})`, 'success');
                    this.updateMonsterAppearance();
                } else if (this.gameData.gold >= skin.price) {
                    this.gameData.gold -= skin.price;
                    this.gameData.skins.push(skinId);
                    this.gameData.equippedSkin = skinId;
                    this.gameData.stats.skinsUnlocked++;
                    this.showNotification(`Куплен скин "${skin.name}"! (x${skin.multiplier})`, 'success');
                    this.updateMonsterAppearance();
                    this.checkAchievements();
                } else {
                    this.showNotification(`Нужно ${this.formatNumber(skin.price)} Gold!`, 'warning');
                }
                
                this.updateUI();
                this.saveGame();
            }
            
            renderLootboxes() {
                return `
                    <div class="lootboxes-section">
                        <h2 class="section-title">
                            <i class="fas fa-gift"></i> Лутбоксы
                        </h2>
                        <div class="lootboxes-grid">
                            <div class="lootbox-card box">
                                <div class="lootbox-icon">
                                    <i class="fas fa-box"></i>
                                </div>
                                <div class="lootbox-name">Обычный бокс</div>
                                <div class="lootbox-description">
                                    Дешевый бокс с малыми шансами на хорошие награды. Большой шанс на пустоту, но могут выпасть такие себе баффы или Gold.
                                </div>
                                <div class="lootbox-chances">
                                    <div class="chance-item">
                                        <span>100-1000 Gold:</span>
                                        <span>80%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Малый бафф:</span>
                                        <span>10%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Редкий скин:</span>
                                        <span>5%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Пустота:</span>
                                        <span>5%</span>
                                    </div>
                                </div>
                                <button class="action-button" onclick="window.engine.buyLootbox('box')" 
                                        ${this.gameData.gold < 5000 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i> Купить за 5,000 Gold
                                </button>
                            </div>
                            
                            <div class="lootbox-card container">
                                <div class="lootbox-icon">
                                    <i class="fas fa-box-open"></i>
                                </div>
                                <div class="lootbox-name">Контейнер</div>
                                <div class="lootbox-description">
                                    Лучше чем бокс. Меньше шанс того, что ничего не выпадет. Могут выпасть хороший бафф, Gold или плохой скин.
                                </div>
                                <div class="lootbox-chances">
                                    <div class="chance-item">
                                        <span>500-5000 Gold:</span>
                                        <span>70%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Средний бафф:</span>
                                        <span>18%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Эпический скин:</span>
                                        <span>10%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Пустота:</span>
                                        <span>2%</span>
                                    </div>
                                </div>
                                <button class="action-button" onclick="window.engine.buyLootbox('container')" 
                                        ${this.gameData.gold < 15000 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i> Купить за 15,000 Gold
                                </button>
                            </div>
                            
                            <div class="lootbox-card case">
                                <div class="lootbox-icon">
                                    <i class="fas fa-briefcase"></i>
                                </div>
                                <div class="lootbox-name">Кейс</div>
                                <div class="lootbox-description">
                                    Могут выпадать любые скины, но очень маленький шанс на редкие. Могут выпасть плохие, средние или топовые баффы или много Gold.
                                </div>
                                <div class="lootbox-chances">
                                    <div class="chance-item">
                                        <span>5000-10000 Gold:</span>
                                        <span>45%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Топовый бафф:</span>
                                        <span>27%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Любой скин:</span>
                                        <span>23%</span>
                                    </div>
                                    <div class="chance-item">
                                        <span>Перманентный множитель:</span>
                                        <span>5%</span>
                                    </div>
                                </div>
                                <button class="action-button" onclick="window.engine.buyLootbox('case')" 
                                        ${this.gameData.gold < 50000 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart"></i> Купить за 50,000 Gold
                                </button>
                            </div>
                        </div>
                        <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> Открыто лутбоксов: ${this.gameData.stats.lootboxesOpened}
                        </div>
                    </div>
                `;
            }
            
            buyLootbox(type) {
                const lootbox = this.lootboxesData[type];
                if (!lootbox) return;
                
                if (this.gameData.gold < lootbox.price) {
                    this.showNotification('Недостаточно Gold!', 'warning');
                    return;
                }
                
                this.gameData.gold -= lootbox.price;
                this.gameData.lootboxes[type]++;
                this.gameData.inventory.push({
                    type: 'lootbox',
                    id: type,
                    name: lootbox.name,
                    icon: lootbox.icon
                });
                
                this.showNotification(`Куплен ${lootbox.name}! Проверьте инвентарь.`, 'success');
                this.updateUI();
                this.saveGame();
            }
            
            renderInventory() {
                let inventoryHTML = '';
                let lootboxCount = 0;
                
                const lootboxCounts = {};
                
                this.gameData.inventory.forEach(item => {
                    if (item.type === 'lootbox') {
                        lootboxCounts[item.id] = (lootboxCounts[item.id] || 0) + 1;
                    }
                });
                
                Object.keys(lootboxCounts).forEach(lootboxId => {
                    const lootbox = this.lootboxesData[lootboxId];
                    if (lootbox) {
                        inventoryHTML += `
                            <div class="inventory-item" onclick="window.engine.openLootbox('${lootboxId}')">
                                <div class="inventory-count">${lootboxCounts[lootboxId]}</div>
                                <div style="font-size: 2rem; margin-bottom: 10px;">
                                    <i class="${lootbox.icon}"></i>
                                </div>
                                <div style="font-size: 0.9rem; color: white;">${lootbox.name}</div>
                                <div style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.6);">Нажмите чтобы открыть</div>
                            </div>
                        `;
                        lootboxCount += lootboxCounts[lootboxId];
                    }
                });
                
                this.gameData.inventory.forEach((item, index) => {
                    if (item.type !== 'lootbox') {
                        inventoryHTML += `
                            <div class="inventory-item">
                                <div style="font-size: 2rem; margin-bottom: 10px;">
                                    <i class="${item.icon || 'fas fa-question'}"></i>
                                </div>
                                <div style="font-size: 0.9rem; color: white;">${item.name}</div>
                                <div style="font-size: 0.8rem; color: rgba(255, 255, 255, 0.6);">${item.description || ''}</div>
                            </div>
                        `;
                    }
                });
                
                if (inventoryHTML === '') {
                    inventoryHTML = `
                        <div style="text-align: center; padding: 50px; color: rgba(255, 255, 255, 0.5);">
                            <i class="fas fa-box-open" style="font-size: 4rem; margin-bottom: 20px;"></i>
                            <div style="font-size: 1.2rem;">Инвентарь пуст</div>
                            <div style="margin-top: 10px;">Купите лутбоксы чтобы получить предметы!</div>
                        </div>
                    `;
                }
                
                return `
                    <div class="inventory-section">
                        <h2 class="section-title">
                            <i class="fas fa-box"></i> Инвентарь
                        </h2>
                        <div class="inventory-grid">
                            ${inventoryHTML}
                        </div>
                        <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> Всего предметов: ${lootboxCount}
                        </div>
                    </div>
                `;
            }
            
            openLootbox(lootboxId) {
                const lootbox = this.lootboxesData[lootboxId];
                if (!lootbox) return;
                
                const lootboxIndex = this.gameData.inventory.findIndex(item => 
                    item.type === 'lootbox' && item.id === lootboxId
                );
                
                if (lootboxIndex === -1 || this.gameData.lootboxes[lootboxId] <= 0) {
                    this.showNotification('У вас нет такого лутбокса!', 'error');
                    return;
                }
                
                this.gameData.lootboxes[lootboxId]--;
                this.gameData.inventory.splice(lootboxIndex, 1);
                this.gameData.stats.lootboxesOpened++;
                
                const totalChance = lootbox.rewards.reduce((sum, reward) => sum + reward.chance, 0);
                let random = Math.random() * totalChance;
                let selectedReward = null;
                
                for (const reward of lootbox.rewards) {
                    if (random < reward.chance) {
                        selectedReward = reward;
                        break;
                    }
                    random -= reward.chance;
                }
                
                if (!selectedReward) {
                    selectedReward = lootbox.rewards[0];
                }
                
                let rewardText = '';
                let rewardIcon = '';
                
                switch(selectedReward.type) {
                    case 'gold':
                        this.gameData.gold += selectedReward.value;
                        rewardText = `${selectedReward.value} Gold`;
                        rewardIcon = '💰';
                        break;
                        
                    case 'boost':
                        const boostData = {
                            type: selectedReward.id.includes('energy') ? 'energy_boost' : 
                                  selectedReward.id.includes('luck') ? 'luck_boost' : 'click_power',
                            name: 'Бонус из лутбокса',
                            icon: 'gift',
                            expires: Date.now() + 60000
                        };
                        
                        if (selectedReward.id === 'small_energy') {
                            this.gameData.energy = Math.min(this.gameData.maxEnergy, this.gameData.energy + 25);
                            rewardText = '+25 энергии';
                            rewardIcon = '⚡';
                        } else if (selectedReward.id === 'medium_energy') {
                            this.gameData.energy = Math.min(this.gameData.maxEnergy, this.gameData.energy + 50);
                            rewardText = '+50 энергии';
                            rewardIcon = '⚡';
                        } else if (selectedReward.id === 'large_energy') {
                            this.gameData.energy = this.gameData.maxEnergy;
                            rewardText = 'Полная энергия';
                            rewardIcon = '⚡';
                        } else if (selectedReward.id === 'permanent_multiplier') {
                            this.gameData.clickPower += 0.5;
                            rewardText = 'Постоянный множитель +0.5';
                            rewardIcon = '✨';
                        } else {
                            this.gameData.activeBoosts.push(boostData);
                            rewardText = 'Временный буст';
                            rewardIcon = '🎁';
                        }
                        break;
                        
                    case 'skin':
                        if (!this.gameData.skins.includes(selectedReward.id)) {
                            this.gameData.skins.push(selectedReward.id);
                            this.gameData.stats.skinsUnlocked++;
                            rewardText = `Скин: ${this.gameData.skinsData[selectedReward.id].name}`;
                            rewardIcon = this.gameData.skinsData[selectedReward.id].icon;
                        } else {
                            const goldValue = selectedReward.value || 10000;
                            this.gameData.gold += goldValue;
                            rewardText = `${goldValue} Gold (вместо дубликата скина)`;
                            rewardIcon = '💰';
                        }
                        break;
                }
                
                this.showRoulette(lootbox.name, rewardText, rewardIcon);
                
                this.updateUI();
                this.checkAchievements();
                this.saveGame();
            }
            
            showRoulette(lootboxName, reward, icon) {
                this.currentReward = { text: reward, icon: icon };
                document.getElementById('rouletteTitle').textContent = `Открытие: ${lootboxName}`;
                document.getElementById('rouletteOverlay').classList.add('show');
                document.getElementById('roulettePrize').classList.remove('show');
            }
            
            hideRoulette() {
                document.getElementById('rouletteOverlay').classList.remove('show');
            }
            
            spinRoulette() {
                const slots = document.querySelectorAll('.roulette-slot');
                const spinButton = document.getElementById('spinButton');
                spinButton.disabled = true;
                
                let spins = 0;
                const totalSpins = 20 + Math.floor(Math.random() * 10);
                
                const spin = () => {
                    slots.forEach(slot => {
                        const symbols = ['🎁', '💰', '💎', '👑', '🔥', '✨', '⚡', '🌟'];
                        const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)];
                        slot.textContent = randomSymbol;
                    });
                    
                    spins++;
                    if (spins < totalSpins) {
                        setTimeout(spin, 100 - (spins * 4));
                    } else {
                        setTimeout(() => {
                            document.getElementById('prizeIcon').textContent = this.currentReward.icon;
                            document.getElementById('prizeName').textContent = this.currentReward.text;
                            document.getElementById('prizeDescription').textContent = 'Поздравляем с выигрышем!';
                            document.getElementById('roulettePrize').classList.add('show');
                            spinButton.disabled = false;
                        }, 500);
                    }
                };
                
                spin();
            }
            
            generateLeaderboard() {
                this.leaderboard = [
                    { playerId: this.gameData.playerId, nickname: this.gameData.nickname, gold: this.gameData.totalGold, level: this.gameData.level }
                ];
                
                const names = ['Shadow', 'Dragon', 'ProGamer', 'ClickMaster', 'GoldHunter', 'MonsterSlayer', 'Legend', 'Champion'];
                for (let i = 0; i < 15; i++) {
                    const gold = Math.floor(Math.random() * 10000000) + 100000;
                    const level = Math.floor(gold / 50000) + 1;
                    
                    this.leaderboard.push({
                        playerId: 'MC_' + Math.random().toString(36).substring(2, 10).toUpperCase(),
                        nickname: names[Math.floor(Math.random() * names.length)] + '_' + Math.floor(Math.random() * 1000),
                        gold: gold,
                        level: level
                    });
                }
                
                this.leaderboard.sort((a, b) => b.gold - a.gold);
            }
            
            updateLeaderboard() {
                const playerIndex = this.leaderboard.findIndex(p => p.playerId === this.gameData.playerId);
                if (playerIndex > -1) {
                    this.leaderboard[playerIndex].gold = this.gameData.totalGold;
                    this.leaderboard[playerIndex].level = this.gameData.level;
                }
                
                this.leaderboard.sort((a, b) => b.gold - a.gold);
                
                if (this.currentTab === 'leaderboard') {
                    this.loadTabContent('leaderboard');
                }
            }
            
            renderLeaderboard() {
                let leaderboardHTML = '';
                
                this.leaderboard.slice(0, 20).forEach((player, index) => {
                    const isCurrentUser = player.playerId === this.gameData.playerId;
                    const rankClass = index === 0 ? 'rank-1' : 
                                     index === 1 ? 'rank-2' : 
                                     index === 2 ? 'rank-3' : '';
                    
                    leaderboardHTML += `
                        <tr class="${isCurrentUser ? 'current-user' : ''}">
                            <td>
                                <span class="rank-badge ${rankClass}">${index + 1}</span>
                                ${player.nickname}
                                ${isCurrentUser ? '<span style="color: var(--gold);">(Вы)</span>' : ''}
                            </td>
                            <td>${this.formatNumber(player.gold)}</td>
                            <td>${player.level}</td>
                            <td>${this.formatNumber(player.gold / player.level)}</td>
                        </tr>
                    `;
                });
                
                const playerRank = this.leaderboard.findIndex(p => p.playerId === this.gameData.playerId) + 1;
                
                return `
                    <div class="leaderboard-section">
                        <h2 class="section-title">
                            <i class="fas fa-trophy"></i> Лидерборд
                        </h2>
                        <div class="leaderboard-container">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <div style="color: white; font-size: 1.1rem;">
                                    <i class="fas fa-crown" style="color: var(--gold);"></i> Топ 20 игроков
                                </div>
                                <div style="color: var(--accent); font-weight: bold;">
                                    Ваш ранг: ${playerRank}
                                </div>
                            </div>
                            <table class="leaderboard-table">
                                <thead>
                                    <tr>
                                        <th>Игрок</th>
                                        <th>Всего Gold</th>
                                        <th>Уровень</th>
                                        <th>Gold/Уровень</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${leaderboardHTML}
                                </tbody>
                            </table>
                            <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                                <i class="fas fa-info-circle"></i> Лидерборд обновляется автоматически
                            </div>
                        </div>
                    </div>
                `;
            }
            
            renderAchievements() {
                let achievementsHTML = '';
                
                Object.values(this.achievementsData).forEach(achievement => {
                    const isUnlocked = this.gameData.achievements.includes(achievement.id);
                    
                    achievementsHTML += `
                        <div class="achievement-card ${isUnlocked ? 'unlocked' : 'locked'}">
                            <div class="achievement-icon">
                                <i class="fas ${achievement.icon}"></i>
                            </div>
                            <div class="achievement-info">
                                <div class="achievement-name">${achievement.name}</div>
                                <div class="achievement-desc">${achievement.description}</div>
                            </div>
                            <div class="achievement-reward">
                                ${isUnlocked ? '✓' : '+' + this.formatNumber(achievement.reward) + ' Gold'}
                            </div>
                        </div>
                    `;
                });
                
                return `
                    <div class="achievements-section">
                        <h2 class="section-title">
                            <i class="fas fa-trophy"></i> Достижения
                        </h2>
                        <div class="achievements-grid">
                            ${achievementsHTML}
                        </div>
                        <div style="margin-top: 20px; color: rgba(255, 255, 255, 0.6); font-size: 0.9rem;">
                            <i class="fas fa-info-circle"></i> Разблокировано: ${this.gameData.achievements.length}/${Object.keys(this.achievementsData).length}
                        </div>
                    </div>
                `;
            }
            
            levelUp() {
                this.gameData.level++;
                this.gameData.experience = 0;
                this.gameData.maxExperience = Math.floor(1000 * Math.pow(1.5, this.gameData.level - 1));
                this.gameData.clickPower += 0.2;
                
                const levelReward = this.gameData.level * 100;
                this.gameData.gold += levelReward;
                
                this.showNotification(`Повышение до уровня ${this.gameData.level}!<br>+${levelReward} Gold<br>+0.2 к силе клика`, 'success');
                this.updateUI();
                this.checkAchievements();
                this.saveGame();
            }
            
            updateMonsterAppearance() {
                const monster = document.querySelector('.monster');
                if (!monster) return;
                
                const skin = this.gameData.skinsData[this.gameData.equippedSkin];
                
                monster.style.background = `linear-gradient(135deg, ${skin.color} 0%, ${this.darkenColor(skin.color, 20)} 100%)`;
                
                const icon = monster.querySelector('i');
                if (icon) {
                    icon.className = skin.icon;
                }
            }
            
            darkenColor(color, percent) {
                const num = parseInt(color.replace('#', ''), 16);
                const amt = Math.round(2.55 * percent);
                const R = (num >> 16) - amt;
                const G = (num >> 8 & 0x00FF) - amt;
                const B = (num & 0x0000FF) - amt;
                return `#${(0x1000000 + (R < 255 ? R < 1 ? 0 : R : 255) * 0x10000 +
                    (G < 255 ? G < 1 ? 0 : G : 255) * 0x100 +
                    (B < 255 ? B < 1 ? 0 : B : 255)).toString(16).slice(1)}`;
            }
            
            updateUI() {
                const goldAmount = document.getElementById('goldAmount');
                const footerGold = document.getElementById('footerGold');
                const energyFill = document.getElementById('energyFill');
                const energyValue = document.getElementById('energyValue');
                const currentLevel = document.getElementById('currentLevel');
                const cpsCounter = document.getElementById('cpsCounter');
                
                if (goldAmount) goldAmount.textContent = this.formatNumber(this.gameData.gold);
                if (footerGold) footerGold.textContent = this.formatNumber(this.gameData.gold);
                
                if (energyFill) {
                    const energyPercent = (this.gameData.energy / this.gameData.maxEnergy) * 100;
                    energyFill.style.width = energyPercent + '%';
                }
                
                if (energyValue) {
                    energyValue.textContent = `${Math.floor(this.gameData.energy)}/${this.gameData.maxEnergy}`;
                }
                
                if (currentLevel) currentLevel.textContent = this.gameData.level;
                if (cpsCounter) cpsCounter.textContent = this.cps;
            }
            
            showNotification(message, type = 'info') {
                const container = document.getElementById('notificationContainer');
                if (!container) return;
                
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <div class="notification-title">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : 
                                            type === 'warning' ? 'exclamation-triangle' : 
                                            type === 'error' ? 'times-circle' : 
                                            'info-circle'}"></i>
                        ${type === 'success' ? 'Успех!' : 
                         type === 'warning' ? 'Внимание!' : 
                         type === 'error' ? 'Ошибка!' : 
                         'Информация'}
                    </div>
                    <div class="notification-message">${message}</div>
                `;
                
                container.appendChild(notification);
                
                setTimeout(() => notification.classList.add('show'), 10);
                
                setTimeout(() => {
                    notification.classList.remove('show');
                    setTimeout(() => notification.remove(), 400);
                }, 3000);
            }
            
            startGameLoop() {
                setInterval(() => {
                    const now = Date.now();
                    
                    let passiveIncome = 0;
                    let businessMultiplier = 1;
                    
                    this.gameData.activeBoosts.forEach(boost => {
                        if (boost.type === 'business_income' && boost.expires > now) {
                            businessMultiplier *= boost.multiplier;
                        }
                    });
                    
                    Object.values(this.gameData.businesses).forEach(business => {
                        if (business.level > 0) {
                            const income = business.income * businessMultiplier;
                            passiveIncome += income;
                            this.gameData.gold += income / 10;
                            this.gameData.totalGold += income / 10;
                            business.totalIncome += income / 10;
                        }
                    });
                    
                    this.gameData.activeBoosts = this.gameData.activeBoosts.filter(boost => boost.expires > now);
                    
                    if (this.gameData.energy < this.gameData.maxEnergy) {
                        let regenRate = this.gameData.energyRegen;
                        this.gameData.energy = Math.min(
                            this.gameData.maxEnergy, 
                            this.gameData.energy + regenRate
                        );
                        this.updateUI();
                    }
                    
                }, 100);
            }
            
            loadGame() {
                try {
                    const saved = localStorage.getItem('monstorclik_save');
                    if (saved) {
                        const data = JSON.parse(saved);
                        if (data.version === '1.4') {
                            this.gameData = { ...this.gameData, ...data.gameData };
                            
                            const playerIdElement = document.getElementById('playerId');
                            if (playerIdElement) {
                                playerIdElement.textContent = this.gameData.playerId;
                            }
                            
                            this.updateUI();
                            this.updateMonsterAppearance();
                            this.generateLeaderboard();
                            
                            // Показываем кнопку продолжить
                            const authContainer = document.querySelector('.auth-container');
                            const startBtn = document.getElementById('startBtn');
                            
                            if (authContainer && startBtn && this.gameData.totalClicks > 0) {
                                const continueBtn = document.createElement('button');
                                continueBtn.className = 'auth-btn continue-btn';
                                continueBtn.innerHTML = '<i class="fas fa-play-circle"></i> ПРОДОЛЖИТЬ ИГРУ';
                                continueBtn.onclick = () => this.startGame();
                                
                                authContainer.insertBefore(continueBtn, startBtn);
                            }
                        }
                    }
                } catch (e) {
                    console.log('Нет сохраненной игры или ошибка загрузки');
                }
            }
            
            saveGame(showNotification = true) {
                try {
                    const saveData = {
                        version: '1.4',
                        timestamp: Date.now(),
                        gameData: this.gameData
                    };
                    
                    localStorage.setItem('monstorclik_save', JSON.stringify(saveData));
                    
                    if (showNotification) {
                        this.showNotification('Игра сохранена!', 'success');
                    }
                } catch (e) {
                    this.showNotification('Ошибка сохранения игры', 'error');
                }
            }
            
            resetGame() {
                if (confirm('ВЫ УВЕРЕНЫ? Весь прогресс будет потерян навсегда!')) {
                    localStorage.removeItem('monstorclik_save');
                    location.reload();
                }
            }
            
            startGame() {
                const authScreen = document.getElementById('authScreen');
                const gameContainer = document.getElementById('gameContainer');
                
                if (authScreen && gameContainer) {
                    authScreen.style.display = 'none';
                    gameContainer.style.display = 'block';
                    
                    this.currentTab = 'clicker';
                    this.loadTabContent('clicker');
                    this.updateUI();
                    this.updateMonsterAppearance();
                    
                    this.showNotification(
                        `Добро пожаловать в MONSTORCLIK!<br>
                         Активно сезонное событие "${this.gameData.seasonalEvent.name}"!`, 
                        'success'
                    );
                    
                    setInterval(() => this.saveGame(false), 30000);
                    
                    console.log('Игра успешно запущена!');
                } else {
                    console.error('Не удалось найти элементы интерфейса!');
                }
            }
            
            formatNumber(num) {
                if (num >= 1000000000) {
                    return (num / 1000000000).toFixed(2) + 'B';
                }
                if (num >= 1000000) {
                    return (num / 1000000).toFixed(2) + 'M';
                }
                if (num >= 1000) {
                    return (num / 1000).toFixed(1) + 'K';
                }
                return Math.floor(num).toLocaleString();
            }
        }
        
        // Инициализация игры после загрузки страницы
        document.addEventListener('DOMContentLoaded', function() {
            window.engine = new MonstorClickEngine();
            console.log('MONSTORCLIK готов к работе!');
        });
    </script>
</body>
</html>